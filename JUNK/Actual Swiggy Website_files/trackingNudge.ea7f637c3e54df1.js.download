webpackJsonp(["trackingNudge"],{"/CEQ":function(t,e){t.exports={container:"_1fKtX",slideUp:"_196wm",containerHide:"n32Go",slideDown:"_3_QG2",iconCtr:"_2NntA",icon:"_3vDYu",iconImg:"_3HGxr",content:"_3tCc7",contentTitle:"_1bDpd",contentDescription:"SOIk0",contentStatus:"_3dVrx",contentETA:"_27u1i",lineProgressBar:"_1W_YY"}},"4GCc":function(t,e,r){"use strict";r.d(e,"f",function(){return f}),r.d(e,"g",function(){return d}),r.d(e,"h",function(){return l}),r.d(e,"b",function(){return b}),r.d(e,"d",function(){return _}),r.d(e,"c",function(){return m}),r.d(e,"a",function(){return O}),r.d(e,"e",function(){return p});var n=r("AdWY"),o=r("UUC3"),u=r("/u0G");function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,o=!1,u=void 0;try{for(var c,i=t[Symbol.iterator]();!(n=(c=i.next()).done)&&(r.push(c.value),!e||r.length!==e);n=!0);}catch(t){o=!0,u=t}finally{try{n||null==i.return||i.return()}finally{if(o)throw u}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var f=function(t,e){return t===e},d=function(t,e){return t>e},l=function(t){return t.length<26?t:t.substring(0,23)+"..."},b=function(t){var e=a(t.split(" "),2),r=e[0],n=e[1],o=a(r.split("-"),3),u=o[0],c=o[1],i=o[2],s=a(n.split(":"),3),f=s[0],d=s[1],l=s[2],b=new Date(Number(u),Number(c),Number(i),Number(f),Number(d),Number(l)),_=b.getHours(),m=b.getMinutes(),O=" AM";0===_?_=12:_>=12&&(_>12&&(_%=12),O=" PM");var p=_.toString(),j=m.toString();return _<10&&(p="0"+_),m<10&&(j="0"+m),p+":"+j+O},_=function(){return o.e},m=function(t){return Object(n.x)(t)?o.e:t.indexOf(o.f)<0?t:t.replace(o.f,o.d)},O=function(t){return!Object(n.x)(t)},p=function(t){return[function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach(function(e){i(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({eventType:u.a.PORTAL_DWEB_ORDER},t)]}},"TWL+":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("VAmG");r.d(e,"default",function(){return n.a})},VAmG:function(t,e,r){"use strict";r.d(e,"a",function(){return h});var n=r("GiK3"),o=r.n(n),u=r("CIox"),c=r("AdWY"),i=r("EJ0c"),a=r("HW6M"),s=r.n(a),f=r("/CEQ"),d=r.n(f),l=r("gBd+"),b=r("W8k2"),_=r("4GCc");function m(t){"@babel/helpers - typeof";return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var r,n=g(t);if(e){var o=g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===m(e)||"function"==typeof e))return e;return y(t)}(this,r)}}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(f,o.a.PureComponent);var e,r,n,a=j(f);function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),v(y(e=a.call(this,t)),"defaultState",{deImage:Object(_.d)()}),v(y(e),"_order",null),v(y(e),"_pollTimeout",null),v(y(e),"_orderKey",void 0),v(y(e),"_poll",function(){e._isMounted&&!Object(c.x)(e._order)&&Object(b.a)(e._order).then(function(t){e._isMounted&&(t.title===e._order.title&&t.message===e._order.message||(e._order=t,Object(c.x)(t.title)?e.reset():e.forceUpdate()),t.expected_time!==e._order.expected_time&&(e._order=t,e.forceUpdate()),null===e._order||Object(b.c)(e._order)||setTimeout(function(){e._isMounted&&e.reset()},l.a))}).catch(function(){}).then(function(){e._isMounted&&!Object(c.x)(e._order)&&e.startPolling()})}),v(y(e),"reset",function(){e._order=null,e.stopPolling(),e.props.fetchLaunchData()}),v(y(e),"goToTrackOrder",function(){u.browserHistory.push(Object(c.j)(l.f,e._orderKey))}),e.state=e.defaultState,e}return e=f,(r=[{key:"_init",value:function(){var t=this;Object(c.x)(this.props.trackData)||Object(b.b)(this.props.trackData).then(function(e){t._isMounted&&Object(b.c)(e)&&window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){t._isMounted&&(t._order=e,t._orderKey=e.order_key,t.props.show(),t.startPolling(),t._updateDEImage())})})}).catch(function(e){Object(i.a)(e),t.reset()})}},{key:"componentDidMount",value:function(){this._isMounted=!0,this._init()}},{key:"componentDidUpdate",value:function(t){JSON.stringify(t.trackData)!==JSON.stringify(this.props.trackData)&&this._init()}},{key:"startPolling",value:function(){Object(b.c)(this._order)&&(this.stopPolling(),this._pollTimeout=setTimeout(this._poll,l.d))}},{key:"stopPolling",value:function(){clearTimeout(this._pollTimeout)}},{key:"render",value:function(){var t;if(!this.props.visible||Object(c.x)(this._order)||Object(c.x)(this.props.trackData))return null;var e=this._order.show_eta,r="";e&&(r=Object(c.j)(l.e.ETA,this._order.expected_time));var n=s()((v(t={},d.a.container,!0),v(t,d.a.containerHide,this.props.willHide),t)),u=this.state.deImage;return o.a.createElement("div",{className:n,onClick:this.goToTrackOrder},e?o.a.createElement("span",{className:d.a.contentETA},r):o.a.createElement("span",{className:d.a.contentStatus},l.e.STATUS),o.a.createElement("div",{className:d.a.content},o.a.createElement("div",{className:d.a.contentTitle},this._order.title),o.a.createElement("div",{className:d.a.contentDescription},Object(c.L)(this._order.message))),o.a.createElement("div",{className:d.a.iconCtr},o.a.createElement("div",{className:d.a.icon},o.a.createElement("img",{src:u,className:d.a.iconImg}))))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.stopPolling()}},{key:"_setState",value:function(t,e){this._isMounted&&this.setState(t,e)}},{key:"_updateDEImage",value:function(){var t=this,e=this._order.image_url,r=Object(_.c)(e),n=new Image;n.onload=function(){t._setState({deImage:r})},n.src=r}}])&&O(e.prototype,r),n&&O(e,n),f}();h.defaultProps={trackData:{}}},W8k2:function(t,e,r){"use strict";r.d(e,"a",function(){return c}),r.d(e,"b",function(){return i}),r.d(e,"c",function(){return a});var n=r("AdWY"),o=r("eBl1"),u=r("sg1u"),c=(r("gBd+"),function(t){return Object(o.e)({order_id:t.order_id,type:"full",is_nudge:!0}).then(function(e){return function(t,e){return Object(n.x)(t)?Promise.reject():{title:u.r(t),message:u.o(t),order_id:u.q(t),annotation:u.m(t),status_code:t.status_code,order_key:e.key,image_url:u.j(t),show_eta:u.a(t),expected_time:u.n(t)}}(e,t)})}),i=function(t){if(Object(n.x)(t)||Object(n.x)(t.orders))return Promise.reject();var e=t.orders[t.orders.length-1];return 1!==e.trackable?Promise.reject():Object(o.b)({order_id:e.order_id,type:"full"}).then(function(t){return Object(n.x)(t)||Object(n.x)(t.orders)?Promise.reject():c(t.orders[0])})},a=function(t){return 0===t.status_code}},YWcv:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n={SUCCESS_STATUS_MESSAGE:"success",INVALID_TRACKING_PARAMS:"Invalid cancellation request via tracking",UNABLE_TO_CANCEL:"Unable to cancel your order. Please try again."}},eBl1:function(t,e,r){"use strict";r.d(e,"b",function(){return _}),r.d(e,"d",function(){return m}),r.d(e,"e",function(){return O}),r.d(e,"c",function(){return p}),r.d(e,"f",function(){return j}),r.d(e,"a",function(){return y});var n=r("/g+L"),o=r("AdWY"),u=r("WGcP"),c=r("1oJu"),i=r("YWcv"),a=r("eRF6");function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach(function(e){d(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t){"@babel/helpers - typeof";return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t){return"object"===l(t.statusMessage)?t.statusMessage.message||a.a:"string"==typeof t.statusMessage?t.statusMessage:a.a}var _=function(t){return Object(o.x)(t)||Object(o.x)(t.order_key)&&Object(o.x)(t.order_id)||Object(o.x)(t.type)?Promise.reject():n.a.get(Object(c.a)(u.c.ORDER_DETAILS),f({},t)).then(function(t){return t.statusCode===u.b?Promise.resolve(t.data):Promise.reject(b(t))})},m=function(t){return Object(o.x)(t)||Object(o.x)(t.order_key)&&Object(o.x)(t.order_id)||Object(o.x)(t.type)?Promise.reject():n.a.post(Object(c.a)(u.c.ORDER_TRACK),f({},t)).then(function(t){return u.f.indexOf(t.statusCode)>=0?(t.data||(t.data={}),t.data.status_code=t.statusCode,Promise.resolve(t.data)):Promise.reject(b(t))}).catch(function(t){return Promise.reject(t)})},O=function(t){return Object(o.x)(t)||Object(o.x)(t.order_key)&&Object(o.x)(t.order_id)||Object(o.x)(t.type)?Promise.reject():n.a.get(Object(c.a)(u.c.ORDER_TRACK_V2),f({},t)).then(function(t){return u.f.indexOf(t.statusCode)>=0?(t.data||(t.data={}),t.data.status_code=t.statusCode,Promise.resolve(t.data)):Promise.reject(b(t))}).catch(function(t){return Promise.reject(t)})},p=function(t){return Object(o.x)(t)||Object(o.x)(t.order_id)?Promise.reject():n.a.get(Object(c.a)(u.c.ORDER_TRACK_DE),f({},t)).then(function(t){return Number(t.statusCode)===u.b?Promise.resolve(t.data):Promise.reject(b(t))})},j=function(t){return n.a.post(Object(c.a)(u.c.ORDER_DELIVERED),{order_id:t.order_id}).then(function(t){return t.statusCode===u.b?Promise.resolve(t):Promise.reject(t)})},y=function(t){if(Object(o.x)(t)||Object(o.x)(t.orderId))return Promise.reject(i.a.INVALID_TRACKING_PARAMS);var e=Object(o.j)(Object(c.a)(u.c.CANCEL_ORDER),t.orderId);return n.a.get(e).then(function(t){var e=Object(o.q)(t,"data.conversation_id","").trim();return t.statusMessage!==i.a.SUCCESS_STATUS_MESSAGE?Promise.reject(t.statusMessage||i.a.UNABLE_TO_CANCEL):""===e?Promise.reject(i.a.UNABLE_TO_CANCEL):Promise.resolve(e)}).catch(function(t){return Promise.reject(t||i.a.UNABLE_TO_CANCEL)})}},eRF6:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n="Oops! Something went wrong!!"},"gBd+":function(t,e,r){"use strict";r.d(e,"c",function(){return n}),r.d(e,"g",function(){return o}),r.d(e,"b",function(){return u}),r.d(e,"d",function(){return c}),r.d(e,"a",function(){return i}),r.d(e,"e",function(){return a}),r.d(e,"f",function(){return s});var n="others_pin_tracking",o="work_pin_tracking",u="home_pin_tracking",c=3e4,i=1e3,a={STATUS:"Status",ETA_MIN:"ETA: {0} mins",ETA:"ETA: {0}"},s="/order-track/{0}"},sg1u:function(t,e,r){"use strict";r.d(e,"p",function(){return u}),r.d(e,"C",function(){return c}),r.d(e,"A",function(){return i}),r.d(e,"E",function(){return a}),r.d(e,"o",function(){return s}),r.d(e,"b",function(){return f}),r.d(e,"v",function(){return d}),r.d(e,"u",function(){return l}),r.d(e,"t",function(){return b}),r.d(e,"F",function(){return _}),r.d(e,"G",function(){return m}),r.d(e,"f",function(){return O}),r.d(e,"i",function(){return p}),r.d(e,"D",function(){return j}),r.d(e,"k",function(){return y}),r.d(e,"j",function(){return g}),r.d(e,"l",function(){return v}),r.d(e,"s",function(){return h}),r.d(e,"c",function(){return E}),r.d(e,"e",function(){return P}),r.d(e,"z",function(){return S}),r.d(e,"d",function(){return w}),r.d(e,"a",function(){return A}),r.d(e,"n",function(){return x}),r.d(e,"m",function(){return k}),r.d(e,"g",function(){return C}),r.d(e,"w",function(){return D}),r.d(e,"h",function(){return T}),r.d(e,"y",function(){return q}),r.d(e,"x",function(){return N}),r.d(e,"B",function(){return R}),r.d(e,"r",function(){return M}),r.d(e,"q",function(){return I});var n=r("AdWY"),o=r("UUC3"),u=function(t){var e=Object(n.q)(t,"order_status.order_state_id",0);return Number(e)},c=function(t){return u(t)===o.m},i=function(t){return u(t)===o.l},a=function(t){var e=u(t);return[o.l,o.m].indexOf(e)>-1},s=function(t){var e=Object(n.q)(t,"order_status.messages",[]).find(function(t){return"order_status"===t.key});return e&&e.show_message&&e.value||""},f=function(t){return Object(n.q)(t,"configuration.show_map",!1)},d=function(t){return f(t)?"":Object(n.q)(t,"outlet_details.outlet_messages","")},l=function(t){return f(t)?"":Object(n.q)(t,"outlet_details.outlet_messages","")},b=function(t){return Object(n.q)(t,"outlet_details.contact_number","")},_=function(t){return!f(t)&&!!Object(n.q)(t,"message_help.ask_confirmation",0)},m=function(t){if(f(t))return!1;var e=b(t);return!(!_(t)&&0===e.length)},O=function(t){var e=Object(n.q)(t,"order_status.icon");return Object(n.m)(e,{colorEffect:"colorEffect",height:44,whiteColor:"whiteColor",width:44})},p=function(t){var e=Object(n.q)(t,"order_status.messages",[]).find(function(t){return"delay_message"===t.key});return e&&e.show_message&&e.value||""},j=function(t){var e=Object(n.q)(t,"delivery_details");return!(!e||!e.delivery_exec_contact_number)},y=function(t){return Object(n.q)(t,"delivery_details.delivery_exec_contact_number","")},g=function(t){return Object(n.q)(t,"delivery_details.delivery_exec_image_url","")},v=function(t){return Object(n.q)(t,"delivery_details.annotation.name","")},h=function(t){return Object(n.q)(t,"order_details.order_state_sequence",[])},E=function(t){return Object(n.q)(t,"configuration.is_de_trackable",!1)},P=function(t){return Object(n.q)(t,"delivery_details.batched_destinations",[]).filter(function(t){return"DONE"!==Object(n.q)(t,"status","").toUpperCase()}).map(function(t){var e,r=Object(n.q)(t,"location",{});return e=r,{lat:Number(Object(n.q)(e,"lat",null)),lng:Number(Object(n.q)(e,"lng",null))}})},S=function(t){return P(t).length>0},w=function(t){return Object(n.q)(t,"delivery_details.batched_order_message",o.o.DELIVERING_ORDER_NEARBY)},A=function(t){return Object(n.q)(t,"order_status.eta.show_eta",!1)},x=function(t){return Object(n.q)(t,"order_status.eta.eta_text","")},k=function(t){switch(Object(n.q)(t,"customer.annotation.name","").toUpperCase()){case"HOME":return"Home";case"WORK":return"Work";default:return!1}},C=function(t){var e=Object(n.q)(t,"customer.annotation.icon",null),r=Object(n.q)(t,"customer.annotation.name","").toUpperCase();if(e)return Object(n.m)(e);switch(r){case"HOME":return o.h;case"WORK":return o.k;default:return o.c}},D=function(t){var e=Object(n.q)(t,"outlet_details.annotation.icon",null);return e?Object(n.m)(e):o.c},T=function(){return o.b},q=function(t){return f(t)?"":Object(n.q)(t,"outlet_details.annotation.name","")},N=function(t){return f(t)?"":Object(n.q)(t,"outlet_details.annotation.name","")},R=function(t){var e=Object(n.q)(t,"delivery_details.location.lat"),r=Object(n.q)(t,"delivery_details.location.lng");return void 0===e||void 0===r},M=function(t){return Object(n.q)(t,"order_status.order_state","")},I=function(t){return Object(n.q)(t,"order_details.order_id","")}}});
//# sourceMappingURL=trackingNudge.ea7f637c3e54df1.js.map